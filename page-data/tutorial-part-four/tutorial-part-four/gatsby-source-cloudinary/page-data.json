{"componentChunkName":"component---src-templates-blog-post-js","path":"/tutorial-part-four//tutorial-part-four/gatsby-source-cloudinary/","result":{"data":{"markdownRemark":{"html":"<p><img src=\"../images/nature-mountains.jpg\" alt=\"Forest\"></p>\n<p>This source plugin queries media files from a Cloudinary account into <code>cloudinaryMedia</code> nodes in your Gatsby project.</p>\n<p><a href=\"https://gsc-sample.netlify.com/\">See a live demo here</a></p>\n<p><a href=\"https://scotch.io/tutorials/handling-images-in-gatsby-with-high-performance\">Here's a tutorial on plugin usage</a></p>\n<h2>Motivation</h2>\n<p>Gatsby offers the ability to develop high performance web pages with a rich developer experience and declarative data fetching Layer with GraphQL.\nCloudinary provides a robust solution to manage media assets, from storage, optimized delivery, to media transformations. Extending the powers of Gatsby with the use of gatsby-source-cloudinary affords the best of both worlds, to allow users store media assets on Cloudinary,\nleveraging Cloudinary's powerful optimization and transformation capabilities in fast sites built with Gatsby.</p>\n<p>While Cloudinary images with on-the-fly transformations can be used during runtime in Gatsby, gatsby-source-cloudinary utilizes the build optimizations of Gatsby.</p>\n<h2>Features</h2>\n<ul>\n<li>Store media files on Cloudinary and deliver through a secure CDN to your Gatsby site</li>\n<li>Average of over 60% image optimizations using <code>f_auto</code> and <code>q_auto</code> applied by default.</li>\n<li>Query Cloudinary images in Gatsby's data layer using GraphQL.</li>\n<li>Utilize Cloudinary's robust transformation suite in media files on a Gatsby site.</li>\n<li>Manage media assets of an application completely on Cloudinary rather than directly in the codebase.</li>\n</ul>\n<p>Looking to use the features of Gatsby-Image with Cloudinary optimized storage, transformations and delivery? Checkout the <a href=\"https://www.npmjs.com/package/gatsby-transformer-cloudinary\">gatsby-transformer-cloudinary</a> plugin.</p>\n<h2>Example usage</h2>\n<p>Here's a sample usage of the source plugin to create an image gallery from images stored on Cloudinary:</p>\n<pre><code class=\"language-jsx\" data-meta=\"harmony\">import React from \"react\"\nimport { useStaticQuery, graphql } from \"gatsby\"\n\nconst SingleImage = () => {\n  const data = useStaticQuery(graphql`\n    query CloudinaryImage {\n      cloudinaryMedia(public_id: { eq: \"gatsby-source-cloudinary/11\" }) {\n        secure_url\n      }\n    }\n  `)\n  const clImage = data.cloudinaryMedia.secure_url\n\n  return (\n    &#x3C;div>\n      &#x3C;div>\n        &#x3C;img src={clImage} alt={\"no alt :(\"} />\n      &#x3C;/div>\n    &#x3C;/div>\n  )\n}\n</code></pre>\n<h2>Installation</h2>\n<p>Install the source plugin using either <code>npm</code> or <code>yarm</code>:</p>\n<pre><code class=\"language-bash\">npm install --save gatsby-source-cloudinary\n</code></pre>\n<h3>Cloudinary Credentials</h3>\n<p>Cloudinary offers a generous free tier which is more than enough to bootstrap projects.\nObtain your cloudname, key and secret from your cloudinary console when you signup at <a href=\"https://cloudinary.com\">Cloudinary.com</a>.</p>\n<h3>Environment configuration</h3>\n<p>Store your <code>cloudName</code>, <code>apiKey</code> and <code>apiSecret</code> as environment variables for security.\nTo do this, create a file in the root of the project named <code>.env</code>. Add your environment variables in it with:</p>\n<pre><code>CLOUDINARY_API_KEY=INSERT API KEY HERE\nCLOUDINARY_API_SECRET=INSERT API SECRET HERE\nCLOUDINARY_CLOUD_NAME=INSERT CLOUDNAME HERE\n</code></pre>\n<p>Install <code>dotenv</code> in your project with:</p>\n<pre><code>yarn add dotenv\n</code></pre>\n<p>In your <code>gatsby-config.js</code> file, require and configure <code>dotenv</code> with:</p>\n<pre><code>require('dotenv').config();\n</code></pre>\n<p>There are several options to configuring <code>dotenv</code> to use different env files either in development or production. You can find that <a href=\"https://www.npmjs.com/package/dotenv\">here</a>.</p>\n<p>Add the <code>.env</code> file to <code>.gitignore</code> so it's not committed.</p>\n<p>Ensure to configure the environment variables on deployment as well.</p>\n<h3>Plugin setup</h3>\n<p>In your <code>gatsby-config.js</code> file, include the plugin like this:</p>\n<pre><code class=\"language-js\">{\n    resolve:`gatsby-source-cloudinary`,\n    options: {\n    cloudName: process.env.CLOUDINARY_CLOUD_NAME,\n    apiKey: process.env.CLOUDINARY_API_KEY,\n    apiSecret: process.env.CLOUDINARY_API_SECRET,\n    resourceType: `image`,\n    type: `type Value`,\n    prefix: `abc-xyz/`\n    }\n}\n</code></pre>\n<h3>Plugin options</h3>\n<p>You can find the plugin options in the table below.</p>\n<table>\n<thead>\n<tr>\n<th>option</th>\n<th>type</th>\n<th>required</th>\n<th>default</th>\n<th>description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>cloudName</code></td>\n<td>string</td>\n<td>true</td>\n<td>n/a</td>\n<td>Cloud name of your Cloudinary account, can be obtained from your <a href=\"https://cloudinary.com/console/\">Cloudinary console</a>. This should be stored and retrieved as an environment variable.</td>\n</tr>\n<tr>\n<td><code>apiKey</code></td>\n<td>string</td>\n<td>true</td>\n<td>na/a</td>\n<td>API Key of your Cloudinary account, can be obtained from your <a href=\"https://cloudinary.com/console/\">Cloudinary console</a>. This should be stored and retrieved as an environment variable.</td>\n</tr>\n<tr>\n<td><code>apiSecret</code></td>\n<td>string</td>\n<td>true</td>\n<td>n/a</td>\n<td>API Secret of your Cloudinary account, can be obtained from your <a href=\"https://cloudinary.com/console/\">Cloudinary console</a>. This should be stored and retrieved as an environment variable.</td>\n</tr>\n<tr>\n<td><code>resourceType</code></td>\n<td>string</td>\n<td>false</td>\n<td>image</td>\n<td>This is the type of file. Possible values: image, raw, video. Note: Use the video resource type for all video resources as well as for audio files, such as .mp3.</td>\n</tr>\n<tr>\n<td><code>type</code></td>\n<td>string</td>\n<td>false</td>\n<td>all</td>\n<td>This is the storage type: upload, private, authenticated, facebook, twitter, gplus, instagram_name, gravatar, youtube, hulu, vimeo, animoto, worldstarhiphop or dailymotion.</td>\n</tr>\n<tr>\n<td><code>maxResults</code></td>\n<td>integer</td>\n<td>false</td>\n<td>10</td>\n<td>Max number of resources to return</td>\n</tr>\n<tr>\n<td><code>tags</code></td>\n<td>boolean</td>\n<td>false</td>\n<td>false</td>\n<td>If true, include the list of tag names assigned to each resource</td>\n</tr>\n<tr>\n<td><code>prefix</code></td>\n<td>string</td>\n<td>false</td>\n<td>n/a</td>\n<td>Find all resources with a public ID that starts with the given prefix. The resources are sorted by public ID in the response.</td>\n</tr>\n<tr>\n<td><code>context</code></td>\n<td>boolean</td>\n<td>false</td>\n<td>n/a</td>\n<td>Specifies if the context data for the image should be returned. This is useful for retrieving <code>alt</code> text or custom metadata in key:value pairs for an image set on Cloudinary.</td>\n</tr>\n</tbody>\n</table>\n<p>With <code>prefix</code>, you can source only media files from a specific folder. However, you will need to specify <code>type</code> and <code>resourceType</code> in the config options.</p>\n<p>An example <code>prefix</code> value is <code>gatsby-anime-videos/</code>. This will fetch only media files with public ids beginning with <code>gatsby-anime-videos/*</code>. Example: <code>gatsby-anime-videos/naruto.mp4</code></p>\n<p>The <code>f_auto</code> and <code>q_auto</code> Cloudinary transformations are applied automatically to all media queries. This optimizes the delivered media quality and format.</p>\n<blockquote>\n<p>All media files sourced from Cloudinary are done when Gatsby creates an optimized build, hence you will need to trigger a new production build whenever new media files are added directly on Cloudinary.</p>\n</blockquote>\n<h2>How to use</h2>\n<p>Once a development server is started using <code>gatsby develop</code>, all media assets configured in the plugin are available as <code>cloudinaryMedia</code> and <code>allCloudinaryMedia</code> in graphQL.\nThese can run in a Page Query or StaticQuery.</p>\n<pre><code class=\"language-jsx\" data-meta=\"harmony\">import React from \"react\"\nimport { useStaticQuery, graphql } from \"gatsby\"\n\nconst Images = () => {\n  const data = useStaticQuery(graphql`\n    query CloudinaryImages {\n      allCloudinaryMedia {\n        edges {\n          node {\n            secure_url\n          }\n        }\n      }\n    }\n  `)\n  const clImages = data.allCloudinaryMedia.edges\n\n  return (\n    &#x3C;div>\n      &#x3C;div>\n        {clImages.map((image, index) => (\n          &#x3C;div key={`${index}-cl`}>\n            &#x3C;img src={image.node.secure_url} />\n          &#x3C;/div>\n        ))}\n      &#x3C;/div>\n    &#x3C;/div>\n  )\n}\n</code></pre>\n<h2>Other Resources</h2>\n<ul>\n<li><a href=\"https://cloudinary.com/documentation/image_transformation_reference\">Cloudinary image transformation reference</a></li>\n<li><a href=\"https://www.npmjs.com/package/gatsby-transformer-cloudinary\">Try the gatsby-transformer-cloudinary plugin to utilize the power of gatsby-image and cloudinary</a></li>\n<li><a href=\"https://www.gatsbyjs.org/docs/using-cloudinary-image-service/\">Using Cloudinary image service for media optimization</a></li>\n</ul>\n<h2>Contribute</h2>\n<p>Want to contribute to make this tool even better? Feel free to send in issues and pull requests on feature requests, fixes, bugs, typos, performance lapses or any other challenge faced with using this tool.</p>\n<h2>License</h2>\n<p>MIT</p>","frontmatter":{"title":"Gatsby-source-cloudinary"},"excerpt":"Forest This source plugin queries media files from a Cloudinary account into cloudinaryMedia nodes in your Gatsby project. See a live demoâ€¦"}},"pageContext":{"slug":"/tutorial-part-four/gatsby-source-cloudinary/"}}}